<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Frete</title>
<style>
body {font-family: Arial, sans-serif; background:#f7f7f7; display:flex; justify-content:center; align-items:flex-start; padding-top:40px; margin:0;}
.container {background:white; padding:30px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1); max-width:600px; width:95%;}
input, select {width:100%; padding:10px; margin:5px 0 15px; border-radius:6px; border:1px solid #ccc; font-size:16px;}
button {padding:10px 15px; font-size:14px; margin-top:10px; border:none; border-radius:6px; background:#2c7be5; color:white; cursor:pointer;}
button:hover {background:#1a5fcc;}
.resultado {margin-top:20px; padding:10px; background:#f3f3f3; border-radius:6px;}
.melhor {background-color:#d1f7c4; padding:5px; border-radius:4px; margin-bottom:5px;}
.autocomplete-items {
  position: absolute;
  border: 1px solid #d4d4d4;
  border-top: none;
  z-index: 99;
  top: 100%; 
  left: 0;
  right: 0;
  max-height: 200px;
  overflow-y: auto;
  background-color: #fff;
}
.autocomplete-items div {
  padding: 10px;
  cursor: pointer;
  border-bottom: 1px solid #d4d4d4;
}
.autocomplete-active {background-color:#2c7be5 !important; color:#fff;}
</style>
</head> 
<body>
  
<a href="index.html" class="voltar-inicio">Voltar</a>
<style>
.voltar-inicio {
    position: fixed;
    top: 10px;
    left: 10px;
    background-color: #40ae1a;
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    text-decoration: none;
    font-weight: bold;
    font-size: 14px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    transition: 0.3s;
    z-index: 9999;
}
.voltar-inicio:hover {
    background-color: #359015;
}
</style>
  
<div class="container">
  <h2>Cotação de Frete</h2>

  <div style="position:relative;">
    <label for="cidade">Cidade</label>
    <input type="text" id="cidade" placeholder="Digite a cidade">
  </div>

  <label for="peso">Peso total (kg)</label>
  <input type="number" id="peso" placeholder="Ex: 100" step="0.01">

  <label for="valor">Valor da mercadoria (R$)</label>
  <input type="number" id="valor" placeholder="Ex: 150.00" step="0.01">

  <label for="ordenar">Ordenar por</label>
  <select id="ordenar">
    <option value="prazo">Menor Prazo</option>
    <option value="valor">Menor Frete</option>
  </select>

  <button onclick="calcularFrete()">Calcular Frete</button>

  <div class="resultado" id="resultado"></div>
</div>

<script>
// JSON Transportadoras
const dados = {
  "transportadoras": [
    {
      "nome": "Cbirdex",
      "valorPorKg": 0.45,
      "valorPorNF": 0.005,
      "taxaColeta": 0,
      "freteMinimo": 60.00,
      "prazos": {
        "Abaiara": 24,
        "Acarape": 24,
        "Acarau": 72,
        "Acopiara": 24,
   	"Aiuaba": 48,
    	"Alcantaras": 72,
    	"Altaneira": 48,
    	"Alto Santo": 72,
    	"Amontada": 72,
    	"Antonina do Norte": 48,
    	"Apuiares": 48,
    	"Aquiraz": 24,
    	"Aracati": 24,
    	"Aracoiaba": 72,
    	"Ararenda": 24,
    	"Araripe": 24,
    	"Aratuba": 72,
    	"Arneiroz": 48,
    	"Assare": 24,
    	"Aurora": 24,
    	"Baixio": 24,
    	"Banabuiu": 48,
    	"Barbalha": 24,
    	"Barreira": 72,
    	"Barro": 48,
    	"Barroquinha": 72,
    	"Baturite": 24,
    	"Beberibe": 24,
    	"Bela Cruz": 72,
    	"Boa Viagem": 48,
    	"Brejo Santo": 24,
    	"Camocim": 72,
    	"Campos Sales": 24,
    	"Caninde": 24,
    	"Capistrano": 72,
    	"Caridade": 72,
    	"Carire": 72,
    	"Caririaçu": 24,
    	"Carius": 48,
    	"Carnaubal": 72,
    	"Cascavel": 24,
    	"Catarina": 48,
    	"Catunda": 24,
    	"Caucaia": 24,
    	"Cedro": 48,
    	"Chaval": 72,
    	"Choro": 48,
    	"Chorozinho": 72,
    	"Coreau": 72,
    	"Crateus": 24,
    	"Crato": 24,
    	"Croata": 24,
    	"Cruz": 72,
    	"Deputado Irapuan Pinheiro": 48,
    	"Erere": 72,
    	"Eusebio": 24,
    	"Farias Brito": 24,
    	"Forquilha": 48,
    	"Fortim": 48,
    	"Frecheirinha": 24,
    	"General Sampaio": 48,
    	"Graça": 72,
    	"Granja": 72,
    	"Granjeiro": 72,
    	"Groairas": 72,
    	"Guaiuba": 72,
    	"Guaraciaba do Norte": 48,
    	"Guaramiranga": 72,
    	"Hidrolandia": 48,
    	"Horizonte": 24,
    	"Ibaretama": 48,
    	"Ibiapina": 48,
    	"Ibicuitinga": 48,
    	"Icapui": 72,
    	"Ico": 24,
    	"Iguatu": 24,
    	"Independencia": 48,
    	"Ipaporanga": 24,
    	"Ipaumirim": 24,
    	"Ipu": 24,
    	"Ipueiras": 48,
    	"Iracema": 72,
    	"Irauçuba": 48,
    	"Itaiçaba": 24,
    	"Itaitinga": 24,
    	"Itapaje": 48,
    	"Itapipoca": 24,
    	"Itapiuna": 72,
    	"Itarema": 72,
    	"Itatira": 72,
    	"Jaguaretama": 72,
    	"Jaguaribara": 72,
    	"Jaguaribe": 24,
    	"Jaguaruana": 24,
    	"Jardim": 24,
    	"Jati": 48,
    	"Jijoca de Jericoacoara": 72,
   	"Juazeiro do Norte": 24,
    	"Jucas": 24,
    	"Lavras da Mangabeira": 48,
    	"Limoeiro do Norte": 24,
    	"Madalena": 48,
    	"Maracanau": 24,
    	"Marco": 72,
    	"Martinopole": 72,
    	"Massape": 72,
   	"Mauriti": 24,
    	"Meruoca": 72,
    	"Milagres": 24,
    	"Milha": 48,
    	"Miraima": 72,
    	"Missão Velha": 24,
    	"Mombaça": 24,
    	"Monsenhor Tabosa": 24,
    	"Morada Nova": 24,
    	"Moraujo": 72,
    	"Morrinhos": 72,
    	"Mucambo": 72,
    	"Mulungu": 72,
    	"Nova Olinda": 24,
    	"Nova Russas": 48,
    	"Novo Oriente": 24,
    	"Ocara": 48,
    	"Oros": 48,
    	"Pacajus": 24,
    	"Pacoti": 72,
    	"Pacuja": 72,
    	"Palhano": 24,
    	"Palmacia": 72,
    	"Paracuru": 48,
    	"Paraipaba": 48,
    	"Parambu": 24,
    	"Paramoti": 72,
    	"Pedra Branca": 48,
    	"Penaforte": 24,
    	"Pentecoste": 48,
    	"Pereiro": 72,
    	"Pindoretama": 24,
    	"Piquet Carneiro": 48,
    	"Pires Ferreira": 48,
    	"Poranga": 24,
    	"Porteiras": 24,
    	"Potengi": 48,
    	"Potiretama": 72,
    	"Quiterianópolis": 24,
    	"Quixada": 24,
    	"Quixelo": 48,
    	"Quixeramobim": 24,
    	"Quixere": 48,
    	"Redenção": 24,
    	"Reriutaba": 48,
    	"Russas": 24,
    	"Saboeiro": 48,
    	"Salitre": 24,
    	"Santa Quiteria": 24,
    	"Santana do Acarau": 72,
    	"Santana do Cariri": 24,
    	"São Benedito": 48,
    	"São Gonçalo do Amarante": 48,
    	"São João do Jaguaribe": 24,
    	"São Luis do Curu": 72,
    	"Senador Pompeu": 24,
    	"Senador Sa": 72,
    	"Sobral": 24,
    	"Solonopole": 24,
    	"Tabuleiro do Norte": 24,
    	"Tamboril": 24,
    	"Tarrafas": 48,
    	"Taua": 24,
    	"Tejuçuoca": 48,
    	"Tiangua": 24,
    	"Trairi": 48,
    	"Tururu": 72,
    	"Ubajara": 48,
    	"Umari": 24,
    	"Umirim": 72,
    	"Uruburetama": 72,
    	"Uruoca": 72,
    	"Varjota": 48,
    	"Varzea Alegre": 24,
    	"Viçosa do Ceara": 48
      }
    },

    {
      "nome": "Ceará Transportes",
      "valorPorKg": 0.50,
      "valorPorNF": 0.0015,
      "taxaColeta": 0,
      "freteMinimo": 60.00,
      "prazos": {
        "Abaiara": 72,
    	"Acarape": 24,
    	"Acopiara": 24,
    	"Aiuaba": "Semanal",
   	"Altaneira": 72,
   	"Alto Santo": 24,
    	"Antonina do Norte": 24,
    	"Aquiraz": 24,
    	"Aracati": 24,
    	"Ararenda": 72,
    	"Araripe": 72,
    	"Arneiroz": 24,
    	"Assare": 24,
    	"Aurora": 24,
    	"Baixio": 24,
    	"Barbalha": 24,
    	"Barreira": 24,
    	"Barro": 24,
    	"Beberibe": 24,
    	"Brejo Santo": 24,
    	"Campos Sales": 24,
    	"Caririaçu": 24,
    	"Cariús": 24,
    	"Cascavel": 24,
    	"Catarina": 24,
    	"Catunda": 24,
    	"Cedro": 24,
    	"Chorozinho": 24,
    	"Crateus": 24,
    	"Crato": 24,
    	"Erere": 24,
    	"Farias Brito": 24,
    	"Fortim": 24,
    	"Granjeiro": 72,
    	"Guaiuba": 24,
    	"Horizonte": 24,
    	"Icapui": "Semanal",
    	"Ico": 24,
    	"Iguatu": 24,
    	"Independencia": 24,
    	"Ipaporanga": 24,
    	"Ipaumirim": 24,
    	"Iracema": 24,
    	"Itaiçaba": 24,
    	"Itaitinga": 24,
    	"Jaguaribara": 24,
    	"Jaguaribe": 24,
    	"Jaguaruana": 24,
    	"Jardim": 72,
    	"Jati": 72,
    	"Juazeiro do Norte": 24,
    	"Jucas": 24,
    	"Lavras da Mangabeira": 24,
    	"Limoeiro do Norte": 24,
    	"Maranhão": 96,
    	"Mauriti": 24,
    	"Milagres": 24,
    	"Missão Velha": 24,
    	"Mombaça": 24,
    	"Monsenhor Tabosa": 72,
    	"Morada Nova": 24,
    	"Nova Olinda": 72,
    	"Nova Russas": 24,
    	"Novo Oriente": 24,
    	"Ocara": 24,
    	"Oros": 24,
    	"Pacajus": 24,
    	"Pacatuba": 24,
    	"Palhano": 24,
    	"Paraiba": 96,
    	"Parambu": 24,
    	"Penaforte": 24,
    	"Pereiro": 72,
    	"Pindoretama": 24,
    	"Poranga": 24,
    	"Porteiras": 24,
    	"Potengi": 72,
    	"Potiretama": 24,
    	"Quiterianopolis": 24,
    	"Quixelo": 24,
    	"Quixere": 24,
    	"Russas": 24,
    	"Saboeiro": "Semanal",
    	"Salitre": 24,
    	"Santana do Cariri": 24,
    	"São João do Jaguaribe": 24,
    	"Tabuleiro do Norte": 24,
    	"Tamboril": 72,
    	"Tarrafas": 24,
    	"Taua": 24,
    	"Umari": 24,
    	"Varzea Alegre": 24
      }
    },

    {
      "nome": "Ceará Transportes",
      "valorPorKg": 0.85,
      "valorPorNF": 0.005,
      "taxaColeta": 25.00,
      "freteMinimo": 140.00,
      "prazos": {
        "Piauí": 96
      }
    },

    {
      "nome": "Potyguar",
      "valorPorKg": 6.0,
      "valorPorNF": 11.0,
      "taxaColeta": 0.01,
      "freteMinimo": 100.00,
      "prazos": {
        "Mossoro": 48,
        "Natal": 48,
        "Rio Grande do Norte": 96
      }
    },
    {
      "nome": "Transportadora D",
      "valorPorKg": 4.8,
      "valorPorNF": 9.0,
      "taxaColeta": 3.0,
      "freteMinimo": 50.00,
      "prazos": {
        "Fortaleza": 24,
        "Maracanau": 24,
        "Caucaia": 24
      }
    }
  ]
};

// Gerar lista de cidades
let cidades = [];
const todasCidades = new Set();
dados.transportadoras.forEach(t => Object.keys(t.prazos).forEach(c => todasCidades.add(c)));
cidades = Array.from(todasCidades).sort();
setupAutocomplete(document.getElementById('cidade'), cidades);

// Função autocomplete
function setupAutocomplete(inp, arr) {
  let currentFocus;
  inp.addEventListener("input", function() {
    let val = this.value;
    closeAllLists();
    if(!val) return false;
    currentFocus = -1;
    let list = document.createElement("DIV");
    list.setAttribute("id", this.id + "-autocomplete-list");
    list.setAttribute("class", "autocomplete-items");
    this.parentNode.appendChild(list);
    arr.forEach(item => {
      if(item.substr(0,val.length).toUpperCase() == val.toUpperCase()){
        let itemDiv = document.createElement("DIV");
        itemDiv.innerHTML = "<strong>"+item.substr(0,val.length)+"</strong>";
        itemDiv.innerHTML += item.substr(val.length);
        itemDiv.innerHTML += "<input type='hidden' value='"+item+"'>";
        itemDiv.addEventListener("click", function(){ inp.value = this.getElementsByTagName("input")[0].value; closeAllLists(); });
        list.appendChild(itemDiv);
      }
    });
  });
  inp.addEventListener("keydown", function(e){
    let x = document.getElementById(this.id + "-autocomplete-list");
    if(x) x = x.getElementsByTagName("div");
    if(e.keyCode == 40){ currentFocus++; addActive(x); }
    else if(e.keyCode == 38){ currentFocus--; addActive(x); }
    else if(e.keyCode == 13){ e.preventDefault(); if(currentFocus > -1){ if(x) x[currentFocus].click(); } }
  });
  function addActive(x){ if(!x) return false; removeActive(x); if(currentFocus>=x.length) currentFocus=0; if(currentFocus<0) currentFocus=x.length-1; x[currentFocus].classList.add("autocomplete-active"); }
  function removeActive(x){ for(let i=0;i<x.length;i++) x[i].classList.remove("autocomplete-active"); }
  function closeAllLists(elmnt){ var x=document.getElementsByClassName("autocomplete-items"); for(var i=0;i<x.length;i++){ if(elmnt!=x[i] && elmnt!=inp) x[i].parentNode.removeChild(x[i]); } }
  document.addEventListener("click", function(e){ closeAllLists(e.target); });
}

// Função para formatar prazo
function formatPrazo(horas){
  if(typeof horas === "string") return horas;
  const dias = Math.floor(horas / 24);
  const restante = horas % 24;
  let str = '';
  if(dias > 0) str += `${dias} dia${dias>1?'s':''} `;
  if(restante > 0) str += `${restante} hora${restante>1?'s':''}`;
  return str.trim();
}

// Cálculo de frete
function calcularFrete() {
  const cidade = document.getElementById('cidade').value.trim();
  const peso = parseFloat(document.getElementById('peso').value);
  const valorMercadoria = parseFloat(document.getElementById('valor').value);
  const ordenarPor = document.getElementById('ordenar').value;

  if(!cidade || isNaN(peso) || isNaN(valorMercadoria)){ 
    alert('Preencha corretamente todos os campos'); 
    return; 
  }

  let opcoes = dados.transportadoras.filter(t => t.prazos[cidade] !== undefined);
  if(opcoes.length === 0){ 
    document.getElementById('resultado').innerText = "Nenhuma transportadora atende esta cidade."; 
    return; 
  }

  opcoes.forEach(t => {
    // cálculo do valor fixo ou percentual da NF
    const valorNF = t.valorPorNF <= 1 ? (t.valorPorNF * valorMercadoria) : t.valorPorNF;

    // taxa de coleta pode ser percentual ou fixa
    const taxaColeta = t.taxaColeta <= 1 ? (t.taxaColeta * valorMercadoria) : t.taxaColeta;

    // cálculo total do frete
    let freteTotal = (t.valorPorKg * peso) + valorNF + taxaColeta;

    // aplica valor mínimo, se houver
    if (t.freteMinimo && freteTotal < t.freteMinimo) {
      freteTotal = t.freteMinimo;
    }

    t.freteTotal = freteTotal;
    t.prazoCidade = t.prazos[cidade];
  });

  if(ordenarPor === 'prazo'){
    opcoes.sort((a,b) => a.prazoCidade - b.prazoCidade);
  } else {
    opcoes.sort((a,b) => a.freteTotal - b.freteTotal);
  }

  let html = "<h3>Melhores transportadoras:</h3>";
  opcoes.slice(0,3).forEach((t,i) => {
    html += `<div class="${i===0?'melhor':''}">
      <strong>${t.nome}</strong> - 
      Prazo: ${formatPrazo(t.prazoCidade)} - 
      Frete: R$ ${t.freteTotal.toFixed(2)}
    </div>`;
  });

  document.getElementById('resultado').innerHTML = html;
}
</script>
</body>
</html>





